<div class="root fill" tabindex="0" (window:resize)="onWindowResize()" (keydown)="onKeyDown($event)" #root>

    <div class="fill scrollContainer"
         (scroll)="onScroll($event)"
         (document:mouseleave)="onMouseOut()"
         (mouseout)="onMouseOut($event)"
         (mousemove)="onMouseMove($event)"
         (mousedown)="onMouseDown($event)"
         (mouseup)="onMouseUp($event)"
         #scrollWrapper>

        <div class="overlay" [style.paddingLeft.px]="annotationGridWidth" [style.height.px]="maxScrollHeight">
            <commit-selection-background
                                        [commitClicked]="commitClicked"
                                        [commitSelected]="commitSelected"
                                        [commitHighlighted]="commitHighlighted">
            </commit-selection-background>
        </div>

        <div class="scrollInner" [style.height.px]="maxScrollHeight">
            <div [style.width.px]="annotationGridWidth">
                <commit-annotations [commits]="historyRepository"
                                    [visibleRange]="visibleRange">
                </commit-annotations>
            </div>
            <div [style.width.px]="currentLaneGridWidth" style="position: relative">
                <commit-lanes [commits]="historyRepository"
                              [visibleRange]="visibleRange"
                              [width]="currentLaneGridWidth"
                              [horizontalScroll]="laneGridScrollPosition"
                              [commitHighlighted]="commitHighlighted"
                              [commitClicked]="commitClicked"
                              [commitSelected]="commitSelected">
                </commit-lanes>
            </div>
            <div style="flex: 1;">
                <commit-titles [commits]="historyRepository"
                               [visibleRange]="visibleRange"
                               [commitHighlighted]="commitHighlighted"
                               [commitClicked]="commitClicked"
                               [commitSelected]="commitSelected">
                </commit-titles>
            </div>
        </div>

        <div class="overlay" style="display: flex" [class.inResizeMode]="isInLaneGridResizeMode || isInAnnotationGridResizeMode" [style.height.px]="maxScrollHeight">
            <div class="resizeBar" [style.left.px]="annotationGridWidth - 5"
                                   [style.height.px]="maxScrollHeight"
                                   (mousedown)="onAnnotationGridResizeMouseDown($event)"
                                   (document:mouseup)="onAnnotationGridResizeMouseUp($event)"
                                   (document:mousemove)="onAnnotationGridResizeMouseMove($event)">
            </div>
            <div class="resizeBar" [style.left.px]="currentLaneGridWidth + annotationGridWidth - 5"
                                   [style.height.px]="maxScrollHeight"
                                   (mousedown)="onLaneGridResizeMouseDown($event)"
                                   (document:mouseup)="onLaneGridResizeMouseUp($event)"
                                   (document:mousemove)="onLaneGridResizeMouseMove($event)">
            </div>
        </div>
    </div>

    <div class="horizontalScrollContainer"
         [class.visible]="mouseIsInLaneGrid || isInLaneGridResizeMode"
         [style.left.px]="annotationGridWidth"
         [style.width.px]="currentLaneGridWidth"
         (scroll)="onLaneGridScroll($event)">
        <div style="opacity: 0; height: 1px;" [style.width.px]="totalLaneGridWidth" ></div>
    </div>
</div>

